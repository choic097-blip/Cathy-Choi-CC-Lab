<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>Project 3 â€“ Ice Coffee â€“ Cathy Choi</title>

  <link rel="stylesheet" href="style.css" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Noto+Sans+KR:wght@300;400;700&display=swap" rel="stylesheet">

  <!-- p5.js (Project 1ê³¼ ë™ì¼) -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/p5.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.11.1/addons/p5.sound.min.js"></script>

  <style>
    #sketch-container {
      margin-top: 40px;
      margin-bottom: 40px;
      text-align: center;
    }
    canvas {
      display: block;
      margin: 0 auto;
      border-radius: 10px;
    }
  </style>
</head>

<body>

  <!-- ğŸ”¥ í†µì¼ëœ íƒ‘ë°” (Project 1ê³¼ ë™ì¼) -->
  <header class="fixed-nav">
    <div class="nav-left">Â©Cathy Choi</div>

    <nav class="nav-center">
      <a href="index.html">Main</a>
      <a href="project_index.html">Projects</a>
      <a href="extra.html">Extra</a>
    </nav>

    <div class="nav-right">
      <a href="#">Contact â†—</a>
    </div>
  </header>

  <!-- í˜ì´ì§€ ë³¸ë¬¸ (Project 1ê³¼ ë™ì¼) -->
  <div class="page-container">

    <h1>Ice Coffee</h1>

    <p class="page-description">
      A time-reactive iced coffee sketch: waves respond to mouse movement, and ice cubes float, melt, and regenerate.
    </p>

    <!-- ìº”ë²„ìŠ¤ ìë¦¬ -->
    <div id="sketch-container"></div>

    <h2>Description</h2>
    <p>
      This sketch visualizes an iced coffee surface that reacts to your mouse motion and the real-world time of day.
      Ice cubes drift, bob, melt, and respawn to keep the scene alive.
    </p>

  </div>

  <!-- ========================= -->
  <!-- p5.js code (ì›ë³¸ ê·¸ëŒ€ë¡œ) -->
  <!-- ========================= -->
  <script>
    function setup() { 
      let c = createCanvas(600, 600); 
      c.parent("sketch-container");

      // ì‹œì‘ ì–¼ìŒ ëª‡ ê°œ 
      for (let i = 0; i < 5; i++) { 
        addIce(); 
      } 
    } 

    function draw() {
      // ë‚®(6~18ì‹œ)ì—ëŠ” ë°ì€ ìƒ‰, ë°¤ì—ëŠ” ì–´ë‘ìš´ ìƒ‰
      let h = hour();
      let m = minute();
      let s = second();

      if (h >= 6 && h < 18) {
        background(200, 220, 255); // ë‚®: ë°ì€ í•˜ëŠ˜ìƒ‰
      } else {
        background(30, 30, 60); // ë°¤: ë‚¨ìƒ‰
      }

      // í™”ë©´ ì¢Œì¸¡ ìƒë‹¨ì— ì‹œê°„ ì¶œë ¥
      fill(255);
      textSize(16);
      text("Time: " + h + ":" + nf(m,2) + ":" + nf(s,2), 20, 20);

      // ì»¤í”¼(ì‚¬ë‹¤ë¦¬ê¼´) + ìœ—ë©´ íŒŒë™ 
      drawCoffee(); 

      // ì–¼ìŒ ì—…ë°ì´íŠ¸ + ê·¸ë¦¬ê¸° 
      for (let ice of iceList) { 
        updateIce(ice); 
        drawIce(ice); 
      } 
    }

    // ì»¤í”¼ë¥¼ ê·¸ë¦½ë‹ˆë‹¤: ì‚¬ë‹¤ë¦¬ê¼´ ëª¸í†µ + ìœ—ë©´ íŒŒë™
    function drawCoffee() { 
      // ë§ˆìš°ìŠ¤ë¥¼ ë¹¨ë¦¬ ì›€ì§ì¼ìˆ˜ë¡ íŒŒë„ê°€ ì»¤ì§ 
      let mouseSpeed = abs(mouseX - pmouseX) + abs(mouseY - pmouseY); 
      let amp = map(mouseSpeed, 0, 80, 2, 12, true); // íŒŒë„ ë†’ì´ 
      wavePhase += map(mouseSpeed, 0, 80, 0.02, 0.2, true); // íŒŒë„ ì§„í–‰ ì†ë„ 

      // xê°’ì— ë”°ë¥¸ ìˆ˜ë©´ yê°’(ë‹¨ì¼ sin íŒŒë™ë§Œ ì‚¬ìš©í•´ì„œ ë‹¨ìˆœí™”) 
      function surfaceY(x) { 
        return coffeeTopY + sin((x + wavePhase * 60) * 0.05) * amp; 
      } 

      // ì»¤í”¼ ì±„ìš°ê¸°(ëª¸í†µ) 
      noStroke(); 
      fill(70, 35, 20);   // ì»¤í”¼ìƒ‰(ê°ˆìƒ‰) 
      beginShape(); 
      // ìœ—ë©´ì˜ íŒŒë™ ë¼ì¸ 
      for (let x = topL; x <= topR; x += 4) { 
        vertex(x, surfaceY(x)); 
      } 
      // ì•„ë«ë©´ìœ¼ë¡œ ë‚´ë ¤ê°€ì„œ ëª¨ì„œë¦¬ ë‹«ê¸° 
      vertex(botR, coffeeBotY); 
      vertex(botL, coffeeBotY); 
      vertex(topL, surfaceY(topL)); 
      endShape(CLOSE); 
    } 

    // ì–¼ìŒ í•˜ë‚˜ë¥¼ ë°°ì—´ì— ì¶”ê°€ 
    function addIce() { 
      iceList.push({ 
        x: cupX + random(-topHalfW + 20, topHalfW - 20), // ìœ—ë©´ í­ ì•ˆì—ì„œ 
        y: coffeeTopY, 
        size: random(34, 50), 
        alpha: 220, 
        vx: random(-0.4, 0.4), // ì¢Œìš° ì´ë™ ì†ë„ 
        bob: random(TWO_PI)    // ë‘¥ì‹¤(ì„¸ë¡œ í”ë“¤ë¦¼) ìœ„ìƒ 
      }); 
    } 

    // ì–¼ìŒì˜ ì›€ì§ì„/ë…¹ëŠ” ê²ƒ ì—…ë°ì´íŠ¸ 
    function updateIce(ice) { 
      // ë§ˆìš°ìŠ¤ ì†ë„ â†’ íŒŒë„ í¬ê¸° 
      let mouseSpeed = abs(mouseX - pmouseX) + abs(mouseY - pmouseY); 
      let amp = map(mouseSpeed, 0, 80, 2, 12, true); 

      // ì–¼ìŒì˜ x ìœ„ì¹˜ì—ì„œì˜ ìˆ˜ë©´ ë†’ì´(= ìœ—ë©´ íŒŒë™) 
      let surf = coffeeTopY + sin((ice.x + wavePhase * 60) * 0.05) * amp; 

      // ë‘¥ì‹¤: ì„¸ë¡œë¡œ ì‚´ì§ ìœ„ì•„ë˜(2px ì •ë„) + ì‚´ì§ ì ê¸°ê²Œ(+3) 
      ice.bob += 0.04; 
      ice.y = surf + sin(ice.bob) * 2 + 3; 

      // ì¢Œìš° ì´ë™: ë§ˆìš°ìŠ¤ í”ë“¤ë¦¼ì— ì˜í–¥ + ì•½ê°„ì˜ ëœë¤ ë“œë¦¬í”„íŠ¸ 
      ice.vx += (mouseX - pmouseX) * 0.001 + random(-0.01, 0.01); 
      ice.vx = constrain(ice.vx, -1, 1); 
      ice.x += ice.vx; 

      // ìœ—ë©´ í­ ì•ˆì—ì„œë§Œ ì›€ì§ì´ê²Œ(ë„ˆë¬´ ë°–ìœ¼ë¡œ ëª» ë‚˜ê°€ê²Œ) 
      let minX = cupX - topHalfW + ice.size * 0.5; 
      let maxX = cupX + topHalfW - ice.size * 0.5; 
      if (ice.x < minX) { ice.x = minX; ice.vx *= -0.4; } 
      if (ice.x > maxX) { ice.x = maxX; ice.vx *= -0.4; } 

      // ë…¹ê¸° 
      ice.size -= 0.015; 
      ice.alpha -= 0.08; 

      // ë„ˆë¬´ ì‘ê±°ë‚˜ íˆ¬ëª…í•´ì§€ë©´, ìœ—ë©´ ê·¼ì²˜ì—ì„œ ìƒˆ ì–¼ìŒìœ¼ë¡œ êµì²´ 
      if (ice.size < 6 || ice.alpha <= 0) { 
        ice.x = cupX + random(-topHalfW + 20, topHalfW - 20); 
        ice.y = coffeeTopY; 
        ice.size = random(34, 50); 
        ice.alpha = 220; 
        ice.vx = random(-0.4, 0.4); 
        ice.bob = random(TWO_PI); 
      } 
    } 

    // ì–¼ìŒì„ ê·¸ë¦¼ 
    function drawIce(ice) { 
      noStroke(); 
      fill(200, 240, 255, ice.alpha);   // ì–¼ìŒ ë³¸ì²´ 
      rectMode(CENTER); 
      rect(ice.x, ice.y, ice.size, ice.size, 8); 

      // í•˜ì´ë¼ì´íŠ¸(ì‚´ì§ ë°ê²Œ) 
      fill(255, 180); 
      rect(ice.x - ice.size * 0.2, ice.y - ice.size * 0.2, ice.size * 0.45, ice.size * 0.45, 6); 
    } 

    // ì»µ ì•ˆì„ í´ë¦­í•˜ë©´ ì–¼ìŒ ì¶”ê°€ 
    function mousePressed() { 
      if (dist(mouseX, mouseY, cupX, cupY) < cupR) { 
        addIce(); 
      } 
    } 

    /// ì •ì˜ë“¤ 
    let cupX = 300;  // ì»µ ì¤‘ì‹¬ X 
    let cupY = 360;  // ì»µ ì¤‘ì‹¬ Y 
    let cupR = 260;  // ì»µ ë°˜ì§€ë¦„(ê·¸ë¦¼ í¬ê¸°) 

    let coffeeTopY = 300;  // ì»¤í”¼ ìœ—ë©´ ë†’ì´ 
    let coffeeBotY = 520;  // ì»¤í”¼ ë°”ë‹¥ ë†’ì´ 
    let topHalfW = 180;    // ìœ—ë©´ ë°˜ìª½ í­ 
    let botHalfW = 150;    // ì•„ë«ë©´ ë°˜ìª½ í­ 

    // ì‚¬ë‹¤ë¦¬ê¼´ ìœ—/ì•„ë«ë³€ ì¢Œí‘œ 
    let topL = cupX - topHalfW; 
    let topR = cupX + topHalfW; 
    let botL = cupX - botHalfW; 
    let botR = cupX + botHalfW; 

    let wavePhase = 0;      // íŒŒë„ ì§„í–‰ê°’(ì‹œê°„) 
    let iceList = [];       // ì–¼ìŒë“¤ì„ ë‹´ëŠ” ë°°ì—´
  </script>

</body>
</html>
